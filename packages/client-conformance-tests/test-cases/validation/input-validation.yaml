id: input-validation
name: Client Input Validation
description: Tests for client-side input parameter validation
category: lifecycle
tags:
  - validation
  - core

tests:
  # IdempotentProducer validation tests (shared across clients)
  - id: producer-valid
    name: Valid IdempotentProducer passes validation
    description: Default producer options should be accepted
    operations:
      - action: validate
        target:
          target: idempotent-producer
          producerId: test-producer
          epoch: 0
          maxBatchBytes: 1048576
        expect:
          valid: true

  - id: producer-negative-epoch
    name: Negative epoch rejected
    description: Client should reject negative epoch
    operations:
      - action: validate
        target:
          target: idempotent-producer
          producerId: test-producer
          epoch: -1
        expect:
          valid: false
          errorCode: INVALID_ARGUMENT
          errorContains: epoch

  - id: producer-zero-max-batch-bytes
    name: Zero maxBatchBytes rejected
    description: Client should reject zero maxBatchBytes (Go treats 0 as default)
    requires:
      - strictZeroValidation
    operations:
      - action: validate
        target:
          target: idempotent-producer
          producerId: test-producer
          maxBatchBytes: 0
        expect:
          valid: false
          errorCode: INVALID_ARGUMENT
          errorContains: maxBatchBytes

  - id: producer-negative-max-batch-bytes
    name: Negative maxBatchBytes rejected
    description: Client should reject negative maxBatchBytes
    operations:
      - action: validate
        target:
          target: idempotent-producer
          producerId: test-producer
          maxBatchBytes: -1
        expect:
          valid: false
          errorCode: INVALID_ARGUMENT
          errorContains: maxBatchBytes
